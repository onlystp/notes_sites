- 以 [睿進](https://drive.google.com/drive/folders/1LCzcp9E1s9QaJQk2rpW56AHw6fod6bJV) 為練習專案。

> [!SUCCESS] 睿進在做什麼的？
> 工業材料製造與批發、電子機械安裝與製造

# SA 需求規格書

## 基本資料管理模組

### 客戶管理模組

- 匯入功能是匯入什麼樣的檔案格式？<span style="color:rgb(0, 176, 80)">看 SDS 文件是寫 CSV、XML 檔，但是跟後端發 API 要資料</span>
  - <span style="color:rgb(0, 176, 80)">沒有畫面的部分，要先把流程畫面想清楚，方便立案會議討論。</span>
  - <span style="color:rgb(0, 176, 80)">比較多邏輯處理的部分，可以跟後端討論，是否後端包辦，前端專注畫面的呈現。</span>
- 條件搜尋：
	- 按查詢才會執行查詢嗎？還是輸入即查詢？<span style="color:rgb(0, 176, 80)">基本上是</span>
- 檢視功能是列表檢視就好了嗎？還是可以點進去客戶單筆檢視？<span style="color:rgb(0, 176, 80)">通常如果規格寫到需要檢視畫面，就會需要檢視按鈕，會依資料量多寡，看是要以 dialog 或是 show 頁面呈現</span>

### 品項管理模組

- 3.3.3.3 如果厚度、寬度、長度只輸入寬跟長，那顯示的規格字串是要：
	- 厚度（顯示 0）x 長度 x 寬度
	- 長度 x 寬度
	- <span style="color:rgb(0, 176, 80)">看一下 SDS 規格，如果送 request 時 key 是分開來，那就請後端幫忙組字串就好，這個邏輯就會是他們決定。</span>

## 類別管理模組

- 「類別」跟 「ERP 類別」的差異跟關係？
	- <span style="color:rgb(0, 176, 80)">類別是客戶提供的固定選單</span>
	- <span style="color:rgb(0, 176, 80)">ERP 類別是讓客戶可以自訂義填入的文字</span>

## 權限管理模組

- 3.3.5.4 權限說明 - 查詢可看到列表畫面，這邊是不需要查詢功能嗎？
	- <span style="color:rgb(0, 176, 80)">這邊的查詢是檢視列表的意思，不代表 filter 功能</span>
	- <span style="color:rgb(0, 176, 80)">補充：權限的細項勾選，會互相影響，如果勾了編輯，查詢當然也要自動勾選。</span>
## 工單管理模組

- 3.4.1.2：
	- 欄位輸入的方式採用自動輸入的方式，是指 Autocomplete（帶搜尋功能的下拉選單）嗎？<span style="color:rgb(0, 176, 80)">Yes</span>
	- 這幾個欄位指：紙筒、紙箱、產品的 ERP 編號、原料的 ERP 編號嗎？<span style="color:rgb(0, 176, 80)">Yes</span>
	- 目前認知「紙筒」、「紙箱」是數於品相管理中的變動項目，因此延伸了兩個問題：
		- 工單資料 - 「紙筒」、「紙箱」欄位是變動的嗎？<span style="color:rgb(0, 176, 80)">不是，原料、產品、紙筒、紙箱都是固定的類別選項</span>
		- 這個選項也會包含在「產品的 ERP 編號」、「原料的 ERP 編號」內嗎？<span style="color:rgb(0, 176, 80)">不包含，這兩個是另外獨立的類別</span>
- 工單的狀態列表（3.4.1.2）上方圖示，是要從哪邊點擊進入查看？<span style="color:rgb(0, 176, 80)">主列表畫面應該要有一個檢視按鈕，可以透過這個按鈕進到工單的報工列表畫面</span>

## 現場報工模組

- 「報工功能」跟「工單管理功能 - 編輯 - 狀態欄位」，這兩個功能的情境差異？
	- <span style="color:rgb(0, 176, 80)">工單管理的編輯，後來畫面有修掉，是無法改變狀態欄位，只能檢視。</span>
	- <span style="color:rgb(0, 176, 80)">報工是給趕單人員，完成訂單後報工用，所以不會有暫停或重新開始的選項。</span>
	- <span style="color:rgb(0, 176, 80)">暫停或重新開始的狀態變更，是在工單管理列表那可以更動，目前的設計稿雖然沒有，但後來有改。</span>
- 3.5.1.2 「**報工時只能填寫原料批號**...」，目前在畫面上並沒有看到原料批號的欄位。
	- <span style="color:rgb(0, 176, 80)">這邊是畫面缺少的，可以在立案會議提出來，請 PM 確認需求，以及規格書是否需要更新。</span>
- 工單管理模組那邊有提到：「製作中」可異動到「暫停中」或「已完成」，目前報工的 dialog 欄位只有 「已完成」的 checkbox，不需要提供「暫停中」的 checkbox 嗎？
	- <span style="color:rgb(0, 176, 80)">「暫停中」跟「製作中」是在報工管理列表，狀態欄位可以下拉去設定的，所以報工動作則是給線上去報「已完成」的工單。</span>
- 3.5.1.3 欄位列表跟畫面上對不太起來：
	- 數量以前應該是指工單列表？
		- 標頭、紙筒在工單列表畫面上並沒有顯示（應該可以直接參考電子看板模組的列表畫面）。
	- 生產數量以後應該是指手動報工？
		- 「設備參數」是「生產參數」嗎？<span style="color:rgb(0, 176, 80)">對</span>
		- 「備註」欄位在畫面上沒有顯示。<span style="color:rgb(0, 176, 80)">可以自己加</span>
- 補充：表單寬度與 scroll 的取捨
	- <span style="color:rgb(0, 176, 80)">QA 測試時，很可能會用極端長字串來測試，需調適每個 td 在長字串下該怎麼排列</span>
	- <span style="color:rgb(0, 176, 80)">盡量讓全部欄位適應在畫面寬度，不要讓使用者必須 scroll 才可以看到全部欄位</span>

## 電子看板模組

- 電子看板 2 要從哪邊進去查看？<span style="color:rgb(0, 176, 80)">因為電子看板只是給人看，不會有修改的行為，所以就固定時間輪播兩個畫面。setInterval 定期撈資料，慣例是 60 second 撈一次資料，15 秒畫面切換。</span>

## 資料介接模組

- 資料介接模組頁面要從哪邊進來？目前主畫面並沒有這個選項
- 3.7.1.1、3.7.1.2 的示意畫面是空的

## 其他問題

> [!SUCCESS] 如果對規格書，是要直接在規格書的 Google Doc 標注嗎？
> 可以跟 PM 溝通

> [!SUCCESS] 如果規格書有待補充或修改的部分，前端工程師可以直接編輯嗎？
> 修改內容只有 PM 有權限，需要跟 PM 提出修改建議。
> 公司內的默契是文件是誰寫的，權限只有他能改，除非經過對方同意。
> 有些商業邏輯不方便在官方規格書寫進去，就會寫進 Redmine 的 Issue 下方

# SDS 規格書

## 全域

- API 常見的 response 欄位 `flash[:notice]` 是後端的 controller action 會自動偵測要不要顯示 `_notice.html.rb` 嗎？<span style="color:rgb(0, 176, 80)">後端在的 Controller Action（轉譯 JSON 階段）會存放在 rails 全域變數 flash 的狀態，是為了可以在畫面跳轉的時候，繼續存取這個資料並顯示 _notice.html.rb 作為使用者反饋 toast。再 survey 一下 rails flash 提供哪些 params</span>
- API 的 request param 如果前端沒有帶的話，是可以的嗎？如何從文件上看出可帶 `null` 或只能是 `empty string` 或可以整個 key 都 undefine？<span style="color:rgb(0, 176, 80)">如果不是必填欄位就可選，然後 id 通常是必填</span>
- 各個列表的 `request.sort` 跟 `request.dir` 有默認預設值嗎？（前端預設要帶的，或是如果前端沒帶，後端預設什麼欄位，然後是 `desc` 或 `asc` 呢？）<span style="color:rgb(0, 176, 80)">預設排序會寫在 SA 規格書</span>
- 各個編輯的 API，過往慣例是全部的 key 都要帶給後端，還是只帶有變更過的欄位就好了呢？<span style="color:rgb(0, 176, 80)">可以跟後端溝通，正常狀況是會整個給</span>

## 權限 Permission

- 權限內容描述 `content: String`，往後看有提到這是一個 JSON 格式的欄位，但關於 JSON 內容 key / value 在文件上找不到定義。
	- <span style="color:rgb(0, 176, 80)">在 config/initilaize/permission_policy.rb 裡面可以找到。這個檔案夾在放不太需要修改的 API 定義。</span>
- 6.3.1.6 送出編輯：request 不需要帶 `id` 嗎？<span style="color:rgb(0, 176, 80)">有，帶在 url query 內</span> 

## 客戶 Customer

- `request.only_blank_ubn` 是只要使用者沒填統一編號，這個欄位就自動帶 `true` 嗎？<span style="color:rgb(0, 176, 80)">不是，這是後來新功能的查詢變數，只為了查詢使用</span>
- `@customer[:類別]`  blueprint 缺少「狀態 key」的定義。應該不需要這個 key 了（因為 customer form 畫面上也沒有這個欄位可以輸入），所以如果要在立案會議後，回頭跟 PM 確認該需求，是在 slack 專案 channel 上 tag PM 嗎？<span style="color:rgb(0, 176, 80)">對，這個後來畫面上不需要，要確認的話就在 slack 專案 channel 跟 PM 確認，確認之後再去 Redmine 記下這個結論的筆記</span>

## 匯入 Import

- API 的 response 並沒有給前端解析 xml 檔之後的 json，只有顯示成功或失敗，所以這邊的匯入是，前端給後端 file  之後，後端直接解析並將每一筆（客戶之類的）存進 DB 嗎？
	- 然後前端收到成功後，再自行 reload 頁面？<span style="color:rgb(0, 176, 80)">對</span>

## 工單

- `GET /work_order/infos` 沒有提供搜尋需要帶的 request params。<span style="color:rgb(0, 176, 80)">請後端補上</span>
- `produced_pcs` 生產數量、`quantity_pcs` 需求數量(顆)、`quantity_boxes` 需求數量(箱) 是後端有給的 keys，但畫面上只有提到「數量(顆)」、「數量(箱)」，是對應後端的哪兩個 keys？<span style="color:rgb(0, 176, 80)">工單的表單畫面應該要有完成數量的欄位，規格書沒有更新而已。所以列表上的「數量(顆)」、「數量(箱)」都是需求數量。</span>
- 新增、編輯的 `customer`、`meterial`，需要帶哪些 keys？
	- `customer` 可以帶 `id` 跟 `name` 就好了嗎？<span style="color:rgb(0, 176, 80)">id 即可</span>
	- `material` 原料跟 `product` 產品，選擇 ERP 編號，會自動帶入厚寬長跟顏色，後者欄位是可以在這個表單客製化填入的嗎？<span style="color:rgb(0, 176, 80)">會自動填入，且不可在工單的 form 裡面更改，要更改要去品項編輯更改。</span>
- 「暫停」跟「恢復」工單目前的功能是在工單列表上，還是工單編輯頁上？<span style="color:rgb(0, 176, 80)">在工單編輯頁右上會有按鈕可以按，這是後來的需求修改，畫面上沒有。</span>
- 「完成」工單在報工頁面可以使用，「結案」工單是在哪個畫面可以觸發？
- 「匯出」工單在哪個畫面可以觸發？<span style="color:rgb(0, 176, 80)">目前是已完成的工單點進去才有按鈕可以按</span>

## 報工

- `reply_work_order`  是要幹嘛的？<span style="color:rgb(0, 176, 80)">是可報工的工單，因為第一頁拿到的列表中，可能不會包含可報工的工單，所以後端將可報工工單存在這個參數。</span>
- 為什麼報工工單 List 特別有 `@pagy` ，其他列表沒有？<span style="color:rgb(0, 176, 80)">應該都有，再檢查一下，如果沒有就是後端沒有給</span>

## 電子看板

- 目前看起來 `dashboard/reload` 的 `work_orders` 是 工單 Panel，`error_state` 是異常代碼，`machine_params` 是設備參數，只有一組，但 設備 Panel 卻需要呈現多個，跟 API 的定義對不太上（不過看起來測試站的另外 5 個設備參數是空資料）。<span style="color:rgb(0, 176, 80)">原本電子看板只有 1 個 Panel，但客戶想要 2 個，但切換到第設備 Panel 只有 1 個設備，在畫面上不符合政府所要求的規格，所以另做了 5 個空設備資料只是畫面需求，實際上只有 1 個。</span>

# 前端測試書

## 撰寫前的疑問

- 參考 [哪一份範例](https://drive.google.com/drive/folders/1ZN4DTrGVglh7bY2jCJF5A0ner1A0a_5_) 比較符合目前的專案開發流程？[K3PMS](https://docs.google.com/spreadsheets/d/13HF8ZpzBEW-zrhATRrY09wZcJx7cZ-7Q4NP_qtnPipk/edit?gid=0#gid=0)
- 需要寫模組編號嗎？<span style="color:rgb(0, 176, 80)">不用，因為看這份測試書的時候，不太需要對照規格書查看</span>
	- 以 [睿進](https://docs.google.com/document/d/1JlJ6nDQHBFUtftjkyXM66-2jb5mjuC30pXB8Q8JcsLU/edit?tab=t.0#heading=h.gjdgxs) 為範例的話，模組編號應該怎麼填？
	- 睿進的模組編號為什麼從 3 開始而不是 1？
- 大的模組分類（比方基本資料、類別管理、工單管理...）是要切成 subsheet 來管理嗎？<span style="color:rgb(0, 176, 80)">可以大方向那樣規劃，並依模組實際項目多寡來調整，重點是要讓人可以讀懂就好</span>

# 溝通

- 如果專案在測試環節遇到無法解決的 issue，會怎麼處理？
- 開案會議開始後，至後端把 Routes 開出來前，前端通常是做：
	- 看 SDS 文件
	- 列出跟後端要討論的問題
	- 調整 Tailwind 設定或全域 style 之類的準備
	- 調整首頁 meta data、page title